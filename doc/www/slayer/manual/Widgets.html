<html lang="en">
<head>
<title>Widgets - SLAYER</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="SLAYER">
<meta name="generator" content="makeinfo 4.13">
<link title="Top" rel="start" href="index.html#Top">
<link rel="prev" href="Direct-Layer.html#Direct-Layer" title="Direct Layer">
<link rel="next" href="Plug_002dins-_0028SCUM_0029.html#Plug_002dins-_0028SCUM_0029" title="Plug-ins (SCUM)">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<!--
Copyright (C) 2013 Panicz Maciej Godek

     Permission is granted to copy, distribute and/or modify this
     document under the terms of the GNU Free Documentation License,
     Version 1.3 or any later version published by the Free Software
     Foundation; with no Invariant Sections, with no Front-Cover Texts,
     and with no Back-Cover Texts.  A copy of the license is included
     in the appendix entitled ``GNU Free Documentation License''.
-->
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
--></style>
</head>
<body>
<div class="node">
<a name="Widgets"></a>
<p>
Next:&nbsp;<a rel="next" accesskey="n" href="Plug_002dins-_0028SCUM_0029.html#Plug_002dins-_0028SCUM_0029">Plug-ins (SCUM)</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="Direct-Layer.html#Direct-Layer">Direct Layer</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="index.html#Top">Top</a>
<hr>
</div>

<h2 class="chapter">3 Widgets</h2>

<p>When developing a graphics user interface based application, it is convinient
to assemble it from simple and elastic components, such as buttons, text areas,
draggable icons, canvases, menus, windows and so on. 
The common name for these components is &ldquo;widget&rdquo;. SLAYER is shipped with its
own framework for creating and using widgets.

<p>In order to use the widget framework, one shall
<code>(use-modules (widgets base))</code>. It creates and exports the main widget
under the symbol <code>*stage*</code>, and sets the appropriate display and resize
procedures, as well as handlers for mouse1 and mouse2 press and release events
and mousemove event.

<p>It also contains a definition of a <code>&lt;widget&gt;</code> class, which is the base
class for all widgets. Here's a simplified definition of  <code>&lt;widget&gt;</code> class
(in fact, all event handler slots are initialized to noop, and their init
keywords correspond strictly to their names):

<p><a name="index-g_t_003cwidget_003e-class-definition-62"></a>
<pre class="lisp">     (define-class &lt;widget&gt; ()
       (parent #:init-value #f #:init-keyword #:parent)
       (children #:init-value '() #:init-keyword #:children)
     
       ;; event handlers (initialized to noop)
       left-mouse-down
       left-mouse-up
       right-mouse-down
       right-mouse-up
       mouse-over
       mouse-out
       drag
       update!
       activate
       deactivate
       resize
     
       (x #:init-value 0 #:init-keyword #:x)
       (y #:init-value 0 #:init-keyword #:y)
       (w #:init-value 0 #:init-keyword #:w)
       (h #:init-value 0 #:init-keyword #:h))
</pre>
<p>As you can see, the widget structure is hierarchical: all widgets (except
<code>*stage*</code>) have their parent, and some can have their children. 
The biggest part of the definition consists of some event handlers, which
are called in certain situations (like clicking, dragging and so on). 
Furthermore, all widgets have rectangular shape, and the rectangle should be
big enough to fit all of the widget's children (otherwise they can become
unreachable).

<p>In order to use the widget framework, it is enough to load the desired
widget modules and add their instances to <code>*stage*</code> using the
<code>(add-child! /instance-of-a-widget/ #;to *stage*)</code>. The simplest program
that uses widgets &ndash; a draggable rectangle &ndash; could look like this:

<p><a name="index-Draggable-rectangle-63"></a>
<pre class="lisp">     (use-modules (slayer) (slayer image)
     	     (widgets base) (widgets bitmap)
     	     (oop goops))
     (keydn 'esc quit)
     
     (define-method (dragger (w &lt;widget&gt;))
       (lambda (x y xrel yrel)
         (slot-set! w 'x (+ (slot-ref w 'x) xrel))
         (slot-set! w 'y (+ (slot-ref w 'y) yrel))))
     
     (let* ((rect (rectangle #;w 50 #;h 50 #;color #xcc33dd))
            (img (make-image rect #;x 50 #;y 50)))
       (slot-set! img 'drag (dragger img))
       (add-child! img #;to *stage*))
</pre>
<p>There are a few widgets already bundled with slayer, among which there is
&lt;text-area&gt; widget (which still requires some work) and &lt;3d-view&gt; widget.

<p>Check the slayer.scm demo to see how to use them.

<p>Note also, that although the direct layer described in the previous chapter
is rather stable and will only be extended rather than modified, the widget
layer is more likely to change.

</body></html>

